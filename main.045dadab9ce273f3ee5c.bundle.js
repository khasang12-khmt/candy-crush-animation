(()=>{"use strict";var e,t={342:(e,t,i)=>{i(260);class s extends Phaser.Scene{constructor(){super({key:"BootScene"})}preload(){this.cameras.main.setBackgroundColor(10016391),this.createLoadingbar(),this.load.on("progress",(e=>{this.progressBar.clear(),this.progressBar.fillStyle(16774867,1),this.progressBar.fillRect(this.cameras.main.width/4,this.cameras.main.height/2-16,this.cameras.main.width/2*e,16)}),this),this.load.on("complete",(()=>{this.progressBar.destroy(),this.loadingBar.destroy()}),this),this.load.pack("preload","./assets/pack.json","preload"),this.load.atlas("flares","assets/particles/flares.png","assets/particles/flares.json"),this.load.image("flare","assets/particles/white-flare.png"),this.load.image("pixel-yellow","assets/particles/pixel_yellow.png"),this.load.image("pixel-white","assets/particles/pixel_white.png"),this.load.image("pixel-red","assets/particles/pixel_red.png"),this.load.image("pixel-green","assets/particles/pixel_green.png"),this.load.image("pixel-blue","assets/particles/pixel_blue.png")}init(){this.registry.set("level",1),this.registry.set("score",0)}update(){this.scene.start("HUDScene"),this.scene.start("GameScene"),this.scene.bringToTop("HUDScene")}createLoadingbar(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(6139463,1),this.loadingBar.fillRect(this.cameras.main.width/4-2,this.cameras.main.height/2-18,this.cameras.main.width/2+4,20),this.progressBar=this.add.graphics()}}const l={score:0,highscore:0,gridWidth:8,gridHeight:8,tileWidth:64,tileHeight:72,candyTypes:["cookie1","cookie2","croissant","cupcake","donut","eclair","macaroon","pie","poptart1","poptart2","starcookie1","starcookie2"],shape:["triangle","rectangle","circle"],matchScore:["0","0","0","100","200","300","400","500"]};class h extends Phaser.GameObjects.Sprite{constructor(e){var t,i,s;if(super(e.scene,e.x,e.y,e.texture,e.frame),this.setOrigin(.5,.5),this.setScale(.8),this.setInteractive(),e.delay){const t=this.y;this.y=t-this.height,this.scene.tweens.add({targets:this,y:t,ease:"Power3",autoDestroy:!0,duration:200,delay:e.delay})}this.scene.add.existing(this);const l=new Phaser.Display.BaseShader("BufferShader2",r);this.selectedShader=this.scene.add.shader(l,this.x-5,this.y,1.2*this.width,1.2*this.height).setDepth(-1).setVisible(!1),this.tileGraphics=this.scene.add.graphics().setDepth(-1).setVisible(!0),this.tileGraphics.lineStyle(2,16777215,1),this.tileGraphics.strokeRoundedRect(this.x-this.width/2-1+4,this.y-this.height/2-1+4,this.width+2-8,this.height+2-8,12),null===(t=this.preFX)||void 0===t||t.setPadding(32),this.matchGlow4FX=null===(i=this.preFX)||void 0===i?void 0:i.addGlow(),this.matchGlow4FX.setActive(!1),this.matchGlow5FX=null===(s=this.preFX)||void 0===s?void 0:s.addGlow(16776960,4,0,!1,.1,32),this.matchGlow5FX.setActive(!1)}revealImageWithDelay(e,t,i){this.scene.tweens.add({targets:this,x:e,y:t,alpha:1,ease:"Power3",autoDestroy:!0,duration:800,delay:i})}getSelected(){this.selectedShader.setX(this.x-5),this.selectedShader.setY(this.y),this.selectedShader.setVisible(!0),this.tileGraphics.setVisible(!0)}getDeselected(){this.selectedShader.setVisible(!1)}getAttracted(){this.suggestedTween||(this.suggestedTween=this.scene.tweens.add({targets:this,scale:.9,yoyo:!0,ease:"sine.inout",autoDestroy:!0,repeat:1,duration:250,onComplete:()=>{var e;null===(e=this.suggestedTween)||void 0===e||e.stop(),this.suggestedTween=void 0,this.setAlpha(1)}}))}enableGlow4(){var e;this.isGlow4=!0,this.matchGlow4FX.setActive(!0),this.match4Tween=null===(e=this.scene)||void 0===e?void 0:e.tweens.add({targets:this.matchGlow4FX,outerStrength:15,yoyo:!0,loop:-1,ease:"sine.inout"})}enableGlow5(){var e;this.isGlow5=!0,this.matchGlow5FX.setActive(!0),this.match4Tween=null===(e=this.scene)||void 0===e?void 0:e.tweens.add({targets:this.matchGlow5FX,outerStrength:25,yoyo:!0,loop:-1,ease:"sine.inout"})}disableGlow(){var e;this.matchGlow4FX.setActive(!1),this.matchGlow5FX.setActive(!1),null===(e=this.match4Tween)||void 0===e||e.destroy(),this.match4Tween=void 0,this.isGlow4=!1,this.isGlow5=!1}isGlowed4(){return this.isGlow4}isGlowed5(){return this.isGlow5}shake(){this.scene.tweens.add({targets:this,scale:0,ease:"bounce.inout",autoDestroy:!0,duration:50,onComplete:()=>{this.destroy()}})}wipe(e,t){var i,s,l,h;"UP"==e?this.matchWipe5FX=null===(i=this.preFX)||void 0===i?void 0:i.addWipe(.3,1,0):"DOWN"==e?this.matchWipe5FX=null===(s=this.preFX)||void 0===s?void 0:s.addWipe(.3,0,0):"LEFT"==e?this.matchWipe5FX=null===(l=this.preFX)||void 0===l?void 0:l.addWipe(.3,1,1):"RIGHT"==e&&(this.matchWipe5FX=null===(h=this.preFX)||void 0===h?void 0:h.addWipe(.3,0,1)),this.scene.tweens.add({targets:this.matchWipe5FX,progress:1,duration:300,easing:"cubic.in",delay:t,onComplete:()=>{this.setActive(!1),this.setAlpha(0)}})}}const r="\nprecision mediump float;\n\nuniform float time;\nuniform vec2 resolution;\nuniform vec2 mouse;\n\nvarying vec2 fragCoord;\n\nvoid main (void)\n{\n    float intensity = 0.;\n\n    for (float i = 0.; i < 54.; i++)\n    {\n        float angle = i/27. * 3.14159;\n        vec2 xy = vec2(0.27 * cos(angle), 0.27 * sin(angle));\n        xy += fragCoord.xy/resolution.y-0.5;\n        intensity += pow(1000000., (0.77 - length(xy) * 1.9) * (1. + 0.275 * fract(-i / 27. - time))) / 80000.;\n    }\n\n    gl_FragColor = vec4(clamp(intensity * vec3(0.0927, 0.396, 0.17), vec3(0.), vec3(0.5)), 0.);\n}\n";class a extends Phaser.Scene{constructor(){super({key:"GameScene"})}init(){this.tilePool=[],this.canMove=!0,this.isSuggested=!1,this.isRedisting=!1,this.isRemoving=!1,this.scoreText=this.add.text(-100,-100,"100",{fontSize:"24px",color:"#fff",fontStyle:"bold"}).setDepth(2),this.cameras.main.setBackgroundColor(9805),this.tileGrid=[];for(let e=0;e<l.gridHeight;e++){this.tileGrid[e]=[];for(let t=0;t<l.gridWidth;t++)this.tileGrid[e][t]=this.addTile(t,e).setAlpha(0)}this.revealTiles(),this.input.on("gameobjectdown",this.tileDown,this),this.input.on("pointermove",(()=>{clearTimeout(this.inactivityTimer),this.idleTweens&&this.idleTweens.stop(),this.inactivityTimer=setTimeout((()=>this.getNextMove()),3e3),this.inactivityTimer=setTimeout((()=>this.idle()),5e3)})),this.input.on("pointerdown",(()=>{this.matchParticle&&(this.matchParticle.stop(),this.isSuggested=!1)})),this.time.delayedCall(2e3,(()=>{this.checkMatches()})),this.confettiParticle=this.add.particles(300,100,"flares",{frame:["red","yellow","green"],lifespan:2e3,speed:{min:50,max:300},angle:{min:0,max:180},scale:{start:.15,end:0},gravityY:100,blendMode:"ADD",emitting:!1,frequency:60}),this.matchParticle=this.add.particles(0,0,"flares",{frame:{frames:["red","green","blue"],cycle:!0},blendMode:"ADD",lifespan:500,emitting:!1,scale:{start:.5,end:.1},duration:500}),this.explodeParticle=this.add.particles(0,0,"flare",{speed:24,lifespan:1500,quantity:10,scale:{start:.3,end:0},emitting:!1,duration:300}),this.match3x3Particle=this.add.particles(0,0,"flares",{frame:{frames:["red","green","blue"],cycle:!0},blendMode:"ADD",lifespan:250,emitting:!1,scale:{start:.5,end:.1}})}revealTiles(){var e,t,i,s;let h=300;for(let r=l.gridHeight-1;r>=0;r--)for(let a=0;a<l.gridWidth;a++){const l=null===(e=this.tileGrid[r][a])||void 0===e?void 0:e.y;null===(t=this.tileGrid[r][a])||void 0===t||t.setY(-200),l&&(null===(i=this.tileGrid[r][a])||void 0===i||i.revealImageWithDelay(null===(s=this.tileGrid[r][a])||void 0===s?void 0:s.x,l,h)),h+=20}}addTile(e,t,i){const s=l.candyTypes[Phaser.Math.RND.between(0,l.candyTypes.length-1)];return new h({scene:this,x:e*l.tileWidth+l.tileWidth/2,y:t*l.tileHeight+l.tileHeight/2,texture:s,delay:i})}reuseTile(e,t,i,s){const h=l.candyTypes[Phaser.Math.RND.between(0,l.candyTypes.length-1)];return e.setTexture(h),e.setPosition(t*l.tileWidth+l.tileWidth/2,-100),e.revealImageWithDelay(t*l.tileWidth+l.tileWidth/2,i*l.tileHeight+l.tileHeight/2,s),e}tileDown(e,t,i){if(this.canMove)if(null==this.firstSelectedTile)this.firstSelectedTile=t,this.firstSelectedTile.getSelected();else{if(this.firstSelectedTile.getDeselected(),this.firstSelectedTile==t)return void(this.firstSelectedTile=void 0);if(this.secondSelectedTile=t,this.secondSelectedTile){const e=Math.abs(this.firstSelectedTile.x-this.secondSelectedTile.x)/l.tileWidth,t=Math.abs(this.firstSelectedTile.y-this.secondSelectedTile.y)/l.tileHeight;1===e&&0===t||0===e&&1===t?(this.canMove=!1,this.swapTiles()):this.firstSelectedTile=void 0}}}swapTiles(){if(this.firstSelectedTile&&this.secondSelectedTile){this.canMove=!1;const e={x:this.firstSelectedTile.x-this.firstSelectedTile.width/2,y:this.firstSelectedTile.y-this.firstSelectedTile.height/2},t={x:this.secondSelectedTile.x-this.firstSelectedTile.width/2,y:this.secondSelectedTile.y-this.firstSelectedTile.height/2};this.tileGrid[Math.floor(e.y/l.tileHeight)][e.x/l.tileWidth]=this.secondSelectedTile,this.tileGrid[Math.floor(t.y/l.tileHeight)][t.x/l.tileWidth]=this.firstSelectedTile,this.add.tween({targets:this.firstSelectedTile,x:this.secondSelectedTile.x,y:this.secondSelectedTile.y,ease:"cubic.inout",duration:600,repeat:0,yoyo:!1,autoDestroy:!0}),this.add.tween({targets:this.secondSelectedTile,x:this.firstSelectedTile.x,y:this.firstSelectedTile.y,ease:"cubic.inout",duration:600,repeat:0,yoyo:!1,onComplete:()=>{this.checkMatches(),this.canMove=!0},autoDestroy:!0}),this.firstSelectedTile=this.tileGrid[Math.floor(e.y/l.tileHeight)][e.x/l.tileWidth],this.secondSelectedTile=this.tileGrid[Math.floor(t.y/l.tileHeight)][t.x/l.tileWidth]}}checkMatches(){const e=this.getMatches(this.tileGrid);e.length>0&&!this.isRemoving?(this.removeTileGroup(e),this.time.delayedCall(300,(()=>{this.resetTile(),this.fillTile(),this.tileUp(),this.checkMatches()}))):(this.tileUp(),this.canMove=!0)}resetTile(){for(let e=this.tileGrid.length-1;e>0;e--)for(let t=this.tileGrid[e].length-1;t>0;t--)if(void 0===this.tileGrid[e][t]&&void 0!==this.tileGrid[e-1][t]){console.log(t,e);const i=this.tileGrid[e-1][t];this.tileGrid[e][t]=i,this.tileGrid[e-1][t]=void 0,this.add.tween({targets:i,y:l.tileHeight*e+l.tileHeight/2,ease:"sine.inout",duration:180,repeat:0,yoyo:!1,autoDestroy:!0}),t=this.tileGrid[e].length,e=this.tileGrid.length;break}}fillTile(){let e=!1;this.canMove=!1;for(let t=0;t<this.tileGrid.length;t++)for(let i=0;i<this.tileGrid[t].length;i++)if(void 0===this.tileGrid[t][i]){const s=this.tilePool.shift();if(s){const l=this.reuseTile(s,i,t,200);this.tileGrid[t][i]=l,e=!0}}this.time.delayedCall(1e3,(()=>{this.matchParticle&&e&&(this.matchParticle.stop(),this.isSuggested=!1),this.canMove=!0}))}tileUp(){this.secondSelectedTile&&(this.firstSelectedTile=void 0,this.secondSelectedTile=void 0)}removeTileGroup(e){var t,i,s,h,r,a,o,d;this.isRemoving=!0;for(const n of e){const e=n;this.scoreText.setPosition(e[1].x-15,e[1].y-5);const c=n.length;this.scoreText.setText(l.matchScore[c]),this.scoreText.setAlpha(1),this.add.tween({targets:this,alpha:0,duration:500,ease:"sine.inout",autoDestroy:!0,onComplete:()=>{this.registry.values.score+=parseInt(l.matchScore[c]),this.scoreText.setAlpha(0),this.events.emit("scoreChanged"),(this.registry.values.score%500==0&&this.registry.values.score>0||this.registry.get("score")>500*this.registry.get("level"))&&(this.canMove=!1,this.matchParticle&&this.matchParticle.stop(!0),this.isSuggested=!0,this.confettiParticle.explode(128),this.time.delayedCall(1500,(()=>{console.log(407),this.canMove&&!this.isRedisting&&this.shuffle()})))}});let[g,p]=[!1,!1];for(const t of e)t.isGlowed5()&&(p=!0);if(!p)for(const t of e)t.isGlowed4()&&(g=!0);if(g){const l=new Phaser.Geom.Rectangle(e[1].x-3*e[0].width/2,e[1].y-3*e[0].height/2,3*e[0].width,3*e[0].height),r=this.explodeParticle.addEmitZone({type:"edge",source:l,quantity:22});this.explodeParticle.start(0,300),this.time.delayedCall(300,(()=>{this.explodeParticle.removeEmitZone(r[0])}));const a=e[0].x==e[1].x;for(const l of e){const e=l,r=this.getTilePos(this.tileGrid,e);-1!==r.x&&-1!==r.y&&(a?(r.x>0&&this.tileGrid[r.y][r.x-1]&&(this.tilePool.push(this.tileGrid[r.y][r.x-1]),null===(s=this.tileGrid[r.y][r.x-1])||void 0===s||s.setActive(!1).setAlpha(0),this.tileGrid[r.y][r.x-1]=void 0),r.x<7&&this.tileGrid[r.y][r.x+1]&&(this.tilePool.push(this.tileGrid[r.y][r.x+1]),null===(h=this.tileGrid[r.y][r.x+1])||void 0===h||h.setActive(!1).setAlpha(0),this.tileGrid[r.y][r.x+1]=void 0)):(r.y>0&&this.tileGrid[r.y-1][r.x]&&(this.tilePool.push(this.tileGrid[r.y-1][r.x]),null===(t=this.tileGrid[r.y-1][r.x])||void 0===t||t.setActive(!1).setAlpha(0),this.tileGrid[r.y-1][r.x]=void 0),r.y<7&&this.tileGrid[r.y+1][r.x]&&(this.tilePool.push(this.tileGrid[r.y+1][r.x]),null===(i=this.tileGrid[r.y+1][r.x])||void 0===i||i.setActive(!1).setAlpha(0),this.tileGrid[r.y+1][r.x]=void 0)))}for(const t of e)t.disableGlow()}else if(p){const t=this.getTilePos(this.tileGrid,e[Math.floor(e.length/2)]);if(-1!==t.x&&-1!==t.y){for(let e=t.y-1;e>=0;e--)this.tileGrid[e][t.x]&&(null===(r=this.tileGrid[e][t.x])||void 0===r||r.wipe("LEFT",10*(t.y-1-e)),this.tilePool.push(this.tileGrid[e][t.x]),this.tileGrid[e][t.x]=void 0);for(let e=t.y+1;e<8;e++)this.tileGrid[e][t.x]&&(null===(a=this.tileGrid[e][t.x])||void 0===a||a.wipe("RIGHT",10*(e-t.y)),this.tilePool.push(this.tileGrid[e][t.x]),this.tileGrid[e][t.x]=void 0);for(let e=t.x-1;e>=0;e--)this.tileGrid[t.y][e]&&(null===(o=this.tileGrid[t.y][e])||void 0===o||o.wipe("UP",10*(t.x-1-e)),this.tilePool.push(this.tileGrid[t.y][e]),this.tileGrid[t.y][e]=void 0);for(let e=t.x+1;e<8;e++)this.tileGrid[t.y][e]&&(null===(d=this.tileGrid[t.y][e])||void 0===d||d.wipe("DOWN",10*(e-t.x)),this.tilePool.push(this.tileGrid[t.y][e]),this.tileGrid[t.y][e]=void 0)}for(const t of e)t.disableGlow()}const u=new Phaser.Geom.Line(0,0,520-e[0].x,100-e[0].y);this.match3x3Particle.setPosition(e[0].x,e[0].y);const y=this.match3x3Particle.addEmitZone({type:"edge",source:u,quantity:32,total:1});switch(this.time.delayedCall(500,(()=>{this.match3x3Particle.removeEmitZone(y[0])})),e.length){case 3:this.add.tween({targets:[e[0],e[1],e[2]],x:e[2].x,y:e[2].y,duration:200,autoDestroy:!0,ease:"sine.in",onComplete:()=>{var t;for(let i=0;i<3;i++){const s=e[i],l=this.getTilePos(this.tileGrid,s);-1!==l.x&&-1!==l.y&&(this.tilePool.push(s),null===(t=this.tileGrid[l.y][l.x])||void 0===t||t.setActive(!1).setAlpha(0),this.tileGrid[l.y][l.x]=void 0)}this.isRemoving=!1}});break;case 4:this.add.tween({targets:[e[0],e[3],e[1]],x:e[2].x,y:e[2].y,duration:200,autoDestroy:!0,ease:"sine.in",onComplete:()=>{var t;for(let i=0;i<4;i++){const s=e[i],l=this.getTilePos(this.tileGrid,s);2!=i&&-1!==l.x&&-1!==l.y&&(this.tilePool.push(s),null===(t=this.tileGrid[l.y][l.x])||void 0===t||t.setActive(!1).setAlpha(0),this.tileGrid[l.y][l.x]=void 0)}this.isRemoving=!1,e[2].enableGlow4()}});break;case 5:this.add.tween({targets:[e[0],e[1],e[3],e[4]],x:e[2].x,y:e[2].y,duration:200,autoDestroy:!0,ease:"sine.in",onComplete:()=>{var t;for(let i=0;i<5;i++){const s=e[i],l=this.getTilePos(this.tileGrid,s);2!=i&&-1!==l.x&&-1!==l.y&&(this.tilePool.push(s),null===(t=this.tileGrid[l.y][l.x])||void 0===t||t.setActive(!1).setAlpha(0),this.tileGrid[l.y][l.x]=void 0)}this.isRemoving=!1,e[2].enableGlow5()}})}}}getTilePos(e,t){const i={x:-1,y:-1};for(let s=0;s<e.length;s++)for(let l=0;l<e[s].length;l++)if(t===e[s][l]){i.x=l,i.y=s;break}return i}getMatches(e){const t=[];let i=[];for(const s of e){const e=s;i=[];for(let l=0;l<e.length;l++)l<e.length-2&&s[l]&&s[l+1]&&s[l+2]&&s[l].texture.key===s[l+1].texture.key&&s[l+1].texture.key===s[l+2].texture.key&&(i.length>0&&-1==i.indexOf(s[l])&&(t.push(i),i=[]),-1==i.indexOf(s[l])&&i.push(s[l]),-1==i.indexOf(s[l+1])&&i.push(s[l+1]),-1==i.indexOf(s[l+2])&&i.push(s[l+2]));i.length>0&&t.push(i)}for(let s=0;s<e.length;s++){const l=e[s];i=[];for(let h=0;h<l.length;h++)h<l.length-2&&e[h][s]&&e[h+1][s]&&e[h+2][s]&&e[h][s].texture.key===e[h+1][s].texture.key&&e[h+1][s].texture.key===e[h+2][s].texture.key&&(i.length>0&&-1==i.indexOf(e[h][s])&&(t.push(i),i=[]),-1==i.indexOf(e[h][s])&&i.push(e[h][s]),-1==i.indexOf(e[h+1][s])&&i.push(e[h+1][s]),-1==i.indexOf(e[h+2][s])&&i.push(e[h+2][s]));i.length>0&&t.push(i)}return t}idle(){let e=0;for(let t=0;t<this.tileGrid.length;t++)for(let i=0;i<this.tileGrid.length;i++)this.idleTweens=this.add.tween({targets:this.tileGrid[i][t],scale:.5,ease:"sine.inout",duration:300,autoDestroy:!0,delay:50*i,repeat:2,yoyo:!0}),e++,e%8==0&&(e=0)}getNextMove(){if(!this.isSuggested&&this.canMove){let e=!1;for(let t=0;t<this.tileGrid.length;t++)for(let i=0;i<this.tileGrid.length;i++)if(void 0!==this.tileGrid[t][i])for(const[s,l]of[[1,0],[-1,0],[0,1],[0,-1]]){const h=t+s,r=i+l;if(h>=0&&h<this.tileGrid.length&&r>=0&&r<this.tileGrid.length&&void 0!==this.tileGrid[h][r]){[this.tileGrid[t][i],this.tileGrid[h][r]]=[this.tileGrid[h][r],this.tileGrid[t][i]];const s=this.getMatches(this.tileGrid);if(s.length>0)return[this.tileGrid[t][i],this.tileGrid[h][r]]=[this.tileGrid[h][r],this.tileGrid[t][i]],void(!this.isSuggested&&this.canMove&&(this.emitSuggestion(s[0],this.tileGrid[t][i],this.tileGrid[h][r]),this.isSuggested=!0));[this.tileGrid[t][i],this.tileGrid[h][r]]=[this.tileGrid[h][r],this.tileGrid[t][i]],t==this.tileGrid.length-1&&i==this.tileGrid.length-1&&(e=!0)}}this.canMove&&!this.isRedisting&&e&&this.shuffle()}}emitSuggestion(e,t,i){t.getAttracted(),i.getAttracted();const[s,l]=[e.reduce(((e,t)=>Math.min(t.x,e)),Number.MAX_SAFE_INTEGER),e.reduce(((e,t)=>Math.min(t.y,e)),Number.MAX_SAFE_INTEGER)],[h,r]=[e.reduce(((e,t)=>Math.max(t.x,e)),Number.MIN_SAFE_INTEGER)+e[0].width,e.reduce(((e,t)=>Math.max(t.y,e)),Number.MIN_SAFE_INTEGER)+e[0].width],a=new Phaser.Geom.Rectangle(-e[0].width/2,-e[0].height/2,-s+h,-l+r),o=this.matchParticle.setPosition(s,l).addEmitZone({type:"edge",source:a,quantity:32,total:1});this.matchParticle.start(1500),this.time.delayedCall(1500,(()=>{this.matchParticle.removeEmitZone(o[0])}))}shuffle(){this.matchParticle&&this.matchParticle.stop(),this.canMove=!1,this.isRedisting=!0;const e=this.tileGrid.flat().filter((e=>null!=e)),t=this.add.group(e),i=l.shape[Phaser.Math.RND.between(0,l.shape.length-1)];let s;"circle"===i?(s=new Phaser.Geom.Circle(300,400,200),Phaser.Actions.PlaceOnCircle(t.getChildren(),s)):"triangle"===i?(s=new Phaser.Geom.Triangle(255,87.5,255-200*Math.cos(Math.PI/6),287.5+200*Math.sin(Math.PI/6),255+200*Math.cos(Math.PI/6),287.5+200*Math.sin(Math.PI/6)),Phaser.Actions.PlaceOnTriangle(t.getChildren(),s)):"rectangle"===i&&(s=new Phaser.Geom.Rectangle(255-200*Math.cos(Math.PI/4),287.5-200*Math.sin(Math.PI/4),400*Math.cos(Math.PI/4),400*Math.cos(Math.PI/4)),Phaser.Actions.PlaceOnRectangle(t.getChildren(),s)),this.add.tween({targets:s,radius:200,ease:"sine.inout",yoyo:!0,duration:1e3,autoDestroy:!0,onStart:()=>{this.matchParticle&&(this.matchParticle.stop(!0),this.matchParticle.setAlpha(0))},onUpdate:function(){"circle"===i?Phaser.Actions.RotateAroundDistance(e,{x:255,y:287.5},.02,200):Phaser.Actions.RotateAround(e,{x:255,y:287.5},.02)},onComplete:()=>{var e,t;this.isRedisting=!1,clearTimeout(this.inactivityTimer);let i=200;for(let s=0;s<l.gridHeight;s++)for(let h=0;h<l.gridWidth;h++){const r=l.candyTypes[Phaser.Math.RND.between(0,l.candyTypes.length-1)];null===(e=this.tileGrid[s][h])||void 0===e||e.setTexture(r),null===(t=this.tileGrid[s][h])||void 0===t||t.revealImageWithDelay(h*l.tileWidth+l.tileWidth/2,s*l.tileHeight+l.tileHeight/2,i),i+=10}this.isSuggested=!0,this.time.delayedCall(2e3,(()=>{this.checkMatches(),this.canMove=!0,this.matchParticle&&(this.matchParticle.stop(),this.matchParticle.setAlpha(1),this.isSuggested=!1)}))}})}}class o extends Phaser.Scene{constructor(){super({key:"HUDScene"})}create(){this.target=500,this.createLoadingbar(),this.progressParticle=this.add.particles(520,160,"flares",{frame:"white",color:[11454159,9887962,9666291],colorEase:"quart.out",lifespan:250,angle:{min:160,max:200},scale:{start:.22,end:0,ease:"sine.in"},speed:{min:100,max:150},advance:2e3,blendMode:"ADD"}).setAlpha(0).setDepth(2),this.textElements=new Map([["TARGET",this.addText(520,8,"Goal: "+500*this.registry.get("level"))],["LEVEL",this.addText(520,48,`Level: ${this.registry.get("level")}`)],["SCORE",this.addText(520,88,`Score: ${this.registry.get("score")}`)]]);const e=this.scene.get("GameScene");e.events.on("scoreChanged",this.updateScore,this),e.events.on("levelChanged",this.updateLevel,this)}addText(e,t,i){return this.add.bitmapText(e,t,"font",i,35)}updateProgress(){this.progressBar.clear(),this.progressBar.fillStyle(8900331,1),this.progressBar.fillRect(522,152,180*this.registry.get("score")/this.target,16),this.progressParticle.setAlpha(1),this.progressParticle.setX(522+180*this.registry.get("score")/this.target)}updateScore(){var e;null===(e=this.textElements.get("SCORE"))||void 0===e||e.setText(`Score: ${this.registry.get("score")}`),this.updateProgress(),!this.textLock&&this.registry.get("score")%500==0&&this.registry.get("score")>0||this.registry.get("score")>500*this.registry.get("level")?(this.registry.values.level+=1,this.textLock=!0,this.time.delayedCall(300,(()=>{this.updateLevel(),this.updateScore(),this.progressParticle.setAlpha(0)}))):this.textLock=!1}updateLevel(){var e,t,i;null===(e=this.textElements.get("LEVEL"))||void 0===e||e.setAlpha(0),this.target+=500,null===(t=this.textElements.get("TARGET"))||void 0===t||t.setText(`Goal: ${this.target}`),null===(i=this.textElements.get("LEVEL"))||void 0===i||i.setAlpha(1).setText(`Level: ${this.registry.get("level")}`),this.updateProgress()}createLoadingbar(){this.loadingBar=this.add.graphics(),this.loadingBar.fillStyle(19597,1),this.loadingBar.fillRect(520,150,182,20),this.progressBar=this.add.graphics()}}const d={title:"Candy crush",url:"https://github.com/digitsensitive/phaser3-typescript",version:"2.0",width:715,height:575,type:Phaser.AUTO,parent:"game",scene:[s,a,o],scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},backgroundColor:"#ffd1dc",render:{pixelArt:!1,antialias:!0},fps:{target:60,forceSetTimeOut:!0}};class n extends Phaser.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{new n(d)}))}},i={};function s(e){var l=i[e];if(void 0!==l)return l.exports;var h=i[e]={exports:{}};return t[e].call(h.exports,h,h.exports,s),h.exports}s.m=t,e=[],s.O=(t,i,l,h)=>{if(!i){var r=1/0;for(n=0;n<e.length;n++){for(var[i,l,h]=e[n],a=!0,o=0;o<i.length;o++)(!1&h||r>=h)&&Object.keys(s.O).every((e=>s.O[e](i[o])))?i.splice(o--,1):(a=!1,h<r&&(r=h));if(a){e.splice(n--,1);var d=l();void 0!==d&&(t=d)}}return t}h=h||0;for(var n=e.length;n>0&&e[n-1][2]>h;n--)e[n]=e[n-1];e[n]=[i,l,h]},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var l,h,[r,a,o]=i,d=0;if(r.some((t=>0!==e[t]))){for(l in a)s.o(a,l)&&(s.m[l]=a[l]);if(o)var n=o(s)}for(t&&t(i);d<r.length;d++)h=r[d],s.o(e,h)&&e[h]&&e[h][0](),e[h]=0;return s.O(n)},i=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var l=s.O(void 0,[216],(()=>s(342)));l=s.O(l)})();